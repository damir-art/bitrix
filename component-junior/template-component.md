# Шаблон компонента
Кастомизация шаблона компонента. 

**Шаблон компонента** - это программный код, преобразующий данные, подготовленные компонентом, в HTML-код.

Прежде чем изменять шаблон компонента, его надо сначалал скопироввать, в папку шаблона сайта.

В шаблоне можно писать PHP-код, использовать API D7, делать прямые запросы к БД даже без API Битрикс.

Вся логика должна быть в компоненте `component.php`, а в шаблоне `template.php` только лишь представление вывода полученных данных.

При кастомизации шаблона компонента его нужно копировать в:

    /local/templates/шаблон_сайта/components/namespace/название_компонента/название_шаблона

## Системные и пользовательские шаблоны
Шаблоны компонента делятся на системные и пользовательские.

Системные шаблоны лежат в папке компонента в подпапке `/templates`. Пользовательские шаблоны кмопонента должны лежать в `/local/templates/шаблон_сайта`.

## Переменные
Переменные, доступные в шаблоне компонента:

- `$templateFile` - путь к шаблону относительно корня сайта, например `/bitrix/components/bitrix/iblock.list/templates/.default/template.php`
- `$arResult` - массив результатов работы компонента
- `$arParams` - массив входящих параметров компонента, может использоваться для учета заданных параметров при выводе шаблона (например, отображении детальных изображений или ссылок)
- `$arLangMessages` - массив языковых сообщений шаблона (для php шаблонов не устанавливается)
- `$templateFolder` - путь к папке с шаблоном от DOCUMENT_ROOT, например `/bitrix/components/bitrix/iblock.list/templates/.default`
- `$parentTemplateFolder` - путь относительно корня сайта к папке шаблона комплексного компонента, в составе которого подключается данный компонент (если компонент подключается самостоятельно, то эта переменная пуста)
- `$component` - ссылка на текущий вызванный компонент (тип CBitrixComponent)
- `$this` - ссылка на текущий шаблон (объект, описывающий шаблон, тип CBitrixComponentTemplate)
- `$templateName` - имя шаблона компонента (например: .dеfault)
- `$componentPath` - путь к папке с компонентом от DOCUMENT_ROOT, например `/bitrix/components/bitrix/iblock.list`
- `$templateData` - массив для записи, обратите внимание, таким образом можно передать данные из `template.php` в файл `component_epilog.php`, причем эти данные попадают в кеш, т.к. файл `component_epilog.php` исполняется на каждом хите

Кроме того внутри PHP шаблона объявлены глобальными переменные `$APPLICATION`, `$USER`, `$DB`.

## Файловая структура шаблона
Файловая структура шаблона, простого компонента. Папка с шаблоном помимо файла `template.php` может содержать другие файлы и подпапки.

- `/lang` - языковые файлы
- `result_modifier.php` - подключается перед шаблоном компонента, получает $arResult и $arParams
- `component_epilog.php` - подключается после шаблона компонента
- `style.css` - стили шаблона
- `script.js` - скрипты шаблона
- `.description.php` - название и описание шаблона для визуального редактора
- `.parameters.php` - описание дополнительных входных параметров шаблона для визуального редактора
- другие файлы и папки, например `/image`

## Файловая структура шаблона комплексного компонента
Шаблон комплексного компонента содержит все те же папки, что и шаблон простого компонента, и дополнительно:

- шаблоны простых компонентов, которые входят в состав комплексного. Эти шаблоны располагаются в папках вида `/пространство_имен/название_простого_компонента/` относительно папки шаблона комплексного компонента
- простые компоненты, входящие в состав комплексного, подключаются на шаблонах страниц комплексного компонента

## Разное
- копировать шаблон компонента можно также еще и через визуальный редактор
- при кастомизации шаблонов можно использовать буферизацию
- если в коде вызова компонента не указать имя шаблона то автоматический подставится `.default`

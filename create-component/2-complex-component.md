# Комплексный компонент
Файловая структура комплексного компонента.
- Основное назначение,
- Логика структуры,
- Логика работы компонента,

Коплексный коспонент в отличии от простого это простой контейнер у которого основная задача это объединить в себе вложенные в него простые компоненты, подключить определённые файлы на странице и сформировать ЧПУ.

Самые основные отличия:
- создание ЧПУ
- объединение настроек комопнента в одной форме

Комплексный компонент всего лишь объединяет в простые компоненты, поэтому он не несет в себе никакой логики. Каждый компонент должен работать автономно, а комплексный из объединяет.

Простые компоненты состоят из двух и более слов.  
Комплексные компоненты состоят из одного слова.

Откроем комплексный компонент `/bitrix/components/bitrix/news/`
- структура файлов такая же как и у простого
  - .description.php - описание комплексного компонента
  - .parameters.php - содержит настройки всех простых компонентов которые входят в комплексный
  - component.php
  - templates/

Отличия также есть при формировании шаблона `templates/`. Внутри этой папки расположены темы, они содержит теже папки что и у простого комопнента плюс может содержать дополнительные файлы. Тема включает в себя шаблоны которые содержат вызовы обычных компонентов. Темах комплексного компонента могут храниться шаблоны обычных компонентов `bitrix/components/bitrix/news/templates/.default/bitrix`.

## Логика комплексного компонента
Логика работы включает:
- анализ входящих данных и параметров
  - на основе которых определяется какая страница шаблона должна быть подключена,
  - после чего формируются параметры для вызова обычных компонентов
- на странице шаблона подключаются обычные компоненты, куда передаются подготовленные параметры, для выводя информации на страницу сайта

Переходим на страницу с комплесным компонентом: site/news/:
- component.php содержит:
  - сбор и обработка входящих параметров
  - далее на строке 279 в зависимости от условия подключится тот или иной файл
  - если get параметра в URL нет то подключается файл `bitrix/components/bitrix/news/templates/.default/news.php`
  - в нём подключаются простые компоненты: поиска, фильтра, news.list
  - в news.list:
    - сюда передаются данные как из массива arParams так и 
    - где arResult это результат работы комплексного компонента
  - открываем детальную стрнаицу (в урл уже есть get параметры например ELEMENT_ID)

В коде компонента есть строки:

  if(isset($arVariables["ELEMENT_ID"]) && intval($arVariables["ELEMENT_ID"]) > 0)
    $componentPage = "detail";

- откроется файл `bitrix/components/bitrix/news/templates/.default/detail.php`

Код в комплексном компоненте component.php достаточно сложен, поддерживает работу компонента как в обычном режиме так и в режиме ЧПУ. Когда разрабатываем комплексный компонент, мы по большей части используем типовой для примера, ведь основное назначение комплексного компонента это объединить простые в себе компоненты и создать ЧПУ.
